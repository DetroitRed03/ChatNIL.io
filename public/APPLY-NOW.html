<!DOCTYPE html>
<html>
<head>
  <title>Apply Matchmaking Setup - ChatNIL</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      max-width: 1600px;
      margin: 20px auto;
      padding: 20px;
      background: #1a1a1a;
      color: #00ff00;
    }
    h1 {
      color: #00ff00;
      font-size: 32px;
      text-align: center;
      margin: 30px 0;
    }
    .hero {
      background: #111;
      padding: 30px;
      margin: 30px 0;
      border: 3px solid #00ff00;
      text-align: center;
    }
    .hero h2 {
      color: #00ff00;
      font-size: 24px;
      margin-bottom: 20px;
    }
    button {
      background: #00ff00;
      color: #000;
      border: none;
      padding: 20px 40px;
      font-size: 22px;
      cursor: pointer;
      font-family: 'Courier New', monospace;
      margin: 20px 10px;
      font-weight: bold;
      border-radius: 5px;
    }
    button:hover {
      background: #00cc00;
      transform: scale(1.05);
      transition: all 0.2s;
    }
    .success {
      color: #00ff00;
      font-size: 28px;
      margin: 30px 0;
      text-align: center;
      padding: 20px;
      background: #0a3d0a;
      border: 2px solid #00ff00;
    }
    pre {
      background: #000;
      padding: 20px;
      overflow-x: auto;
      border: 2px solid #00ff00;
      max-height: 600px;
      overflow-y: auto;
      font-size: 13px;
      line-height: 1.5;
    }
    .steps {
      background: #111;
      padding: 30px;
      margin: 30px 0;
      border-left: 5px solid #00ff00;
    }
    .steps li {
      margin: 15px 0;
      font-size: 18px;
      line-height: 1.6;
    }
    .steps strong {
      color: #00ff00;
    }
    a {
      color: #00aaff;
      text-decoration: underline;
      font-weight: bold;
    }
    .what-this-does {
      background: #0a0a2d;
      padding: 20px;
      margin: 20px 0;
      border-left: 5px solid #00aaff;
    }
    .what-this-does h3 {
      color: #00aaff;
    }
    .what-this-does ul {
      font-size: 16px;
      line-height: 1.8;
    }
  </style>
</head>
<body>
  <h1>üöÄ COMPLETE MATCHMAKING SYSTEM SETUP</h1>

  <div class="hero">
    <h2>‚ú® One Click to Complete Setup</h2>
    <p style="font-size: 18px; margin: 20px 0;">This creates tables AND inserts all data in one go!</p>
    <button onclick="copyAndGo()" id="mainBtn">
      üìã COPY SQL & OPEN SUPABASE
    </button>
  </div>

  <div id="status"></div>

  <div class="what-this-does">
    <h3>üìä What This SQL Does:</h3>
    <ul>
      <li>‚úÖ Creates <code>nil_deals</code> table (with RLS policies)</li>
      <li>‚úÖ Creates <code>state_nil_rules</code> table (with 10 state rules)</li>
      <li>‚úÖ Inserts 3 NIL deals for Sarah Johnson ($8,500 total)</li>
      <li>‚úÖ Inserts 5 active campaigns from agencies</li>
      <li>‚úÖ Inserts 3 agency-athlete matches (scores: 85, 78, 72)</li>
    </ul>
    <p style="margin-top: 20px; font-size: 16px;">
      <strong>Safe to run multiple times</strong> - Uses <code>ON CONFLICT DO NOTHING</code> and <code>CREATE IF NOT EXISTS</code>
    </p>
  </div>

  <div class="steps">
    <h2>üìã Manual Steps (if auto-open fails):</h2>
    <ol>
      <li><strong>Click the button above</strong> - SQL copied to clipboard</li>
      <li><strong>Supabase opens automatically</strong> - Or <a href="https://supabase.com/dashboard/project/lqskiijspudfocddhkqs/sql/new" target="_blank">click here</a></li>
      <li><strong>Paste (Cmd+V)</strong> the SQL in the editor</li>
      <li><strong>Click "Run"</strong> at the bottom right</li>
      <li><strong>Verify success</strong> - Should show counts at the bottom</li>
    </ol>
  </div>

  <details style="margin: 30px 0;">
    <summary style="cursor: pointer; font-size: 18px; color: #00ff00; margin-bottom: 10px;">
      üìÑ View Full SQL (click to expand)
    </summary>
    <pre id="sqlPreview">Loading SQL...</pre>
  </details>

  <script>
    // Load SQL
    fetch('/FINAL_WORKING_SETUP.sql')
      .then(res => res.text())
      .then(sql => {
        document.getElementById('sqlPreview').textContent = sql;
        window.sqlContent = sql;
        console.log('‚úÖ SQL loaded, ready to copy');
      })
      .catch(err => {
        document.getElementById('sqlPreview').textContent = 'Error loading SQL: ' + err.message;
      });

    function copyAndGo() {
      if (!window.sqlContent) {
        alert('‚è≥ SQL still loading, please wait a moment...');
        setTimeout(copyAndGo, 500);
        return;
      }

      // Copy to clipboard
      navigator.clipboard.writeText(window.sqlContent).then(() => {
        // Show success
        const status = document.getElementById('status');
        status.innerHTML = `
          <div class="success">
            ‚úÖ SQL COPIED TO CLIPBOARD!<br><br>
            Supabase SQL Editor should open in a new tab...<br>
            If not, <a href="https://supabase.com/dashboard/project/lqskiijspudfocddhkqs/sql/new" target="_blank">CLICK HERE</a><br><br>
            Then paste (Cmd+V) and click RUN
          </div>
        `;

        // Open Supabase SQL Editor
        window.open('https://supabase.com/dashboard/project/lqskiijspudfocddhkqs/sql/new', '_blank');

        // Update button
        document.getElementById('mainBtn').textContent = '‚úÖ SQL COPIED - Go paste in Supabase!';
        document.getElementById('mainBtn').style.background = '#00aa00';

      }).catch(err => {
        alert('‚ùå Copy failed: ' + err.message + '\\n\\nPlease manually select and copy the SQL below.');
      });
    }
  </script>
</body>
</html>
